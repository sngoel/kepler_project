---
title: "Project"
author: "Daniel Walker"
date: "4/30/2019"
output: html_document
---
```{r echo=TRUE, message=FALSE}
# always clean up R environment
rm (list = ls ())

#install.packages('RCurl')

# load all packages here
library (mdsr)
library(dplyr) # for data manipluation
library(ggplot2) # data visualization
library(reshape2) # reshaping 

# user-defined functions here (if any)

# load data

```

```{r}
# read data https://www.kaggle.com/starbucks/starbucks-menu
drinks_expanded <- read.csv('starbucks_drinkMenu_expanded.csv')
food <- read.csv('starbucks-menu-nutrition-food.csv')

# as the data seems to contains some trademarks and accent, we will first remove them
drinks_expanded$Beverage_category <- iconv(drinks_expanded$Beverage_category, "latin1", "ASCII", sub = "byte")
drinks_expanded$Beverage <- iconv(drinks_expanded$Beverage, "latin1", "ASCII", sub = "byte")
drinks_expanded$Beverage_prep <- iconv(drinks_expanded$Beverage_prep, "latin1", "ASCII", sub = "byte")

drinks_expanded$Beverage_category <- gsub('(<[a-z0-9]+>)','',drinks_expanded$Beverage_category)
drinks_expanded$Beverage <- gsub('(<[a-z0-9]+>)','',drinks_expanded$Beverage)
drinks_expanded$Beverage_prep <- gsub('(<[a-z0-9]+>)','',drinks_expanded$Beverage_prep)
```

### Quick view of Data
```{r}
head(food)
head(drinks_expanded)
```

### Plot Strar Bucks Food (Calories and Fat)
```{r}
# red line shows recomended meal amount of Calories for food
# blue line shows MAX recomended daily amount of Fat for Food

# https://www.uccs.edu/healthcircle/sites/healthcircle/files/inline-files/Meal%20Planning.pdf
# https://my.clevelandclinic.org/health/articles/11208-fat-what-you-need-to-know

plot(Calories~Fat, 
     ylab = 'Calories in Starbucks Food', 
     xlab = 'Fat in Starbucks Food',
     main = 'Caleries vs Fat for Starbucks Food', 
     data = food)
abline(v=22,col='blue')
abline(h=500,col='red')

food %>%
  select(Food.name,Calories,Fat) %>%
  filter(Calories>=500,Fat>=22) %>% 
  count(Food.name) %>% 
  ungroup() %>% 
  arrange(desc(n))

# Unhealthiest Option
food %>%
  select(Food.name,Calories,Fat) %>%
  filter(Calories>=600,Fat>=28) %>% 
  count(Food.name) %>% 
  ungroup() %>% 
  arrange(desc(n))
if(FALSE){
"
Green Goddess Avocado Salad			
Lentils & Vegetable Protein Bowl with Brown Rice		
Roasted Turkey & Dill Havarti Sandwich
"
}
```

### Plot Strar Bucks Drink (Calories and Total Fat)
```{r}
# red line shows recomended meal amount of Calories for food

# https://www.uccs.edu/healthcircle/sites/healthcircle/files/inline-files/Meal%20Planning.pdf
# https://my.clevelandclinic.org/health/articles/11208-fat-what-you-need-to-know

plot(Calories~Total_Fat, 
     ylab = 'Calories in Starbucks Drinks', 
     xlab = 'Total Fat in Starbucks Food',
     main = 'Caleries vs Total Fat for Starbucks Drinks', 
     data = drinks_expanded)
abline(h=500,col='red')
```

### Plot Strar Bucks Drink (Sugars and Total Fat)
```{r}
# red line shows MAX recomended meal amount of sugar for food

# http://sugarscience.ucsf.edu/the-growing-concern-of-overconsumption.html

plot(Sugars~Total_Fat, 
     xlab = 'Fat in Starbucks Drinks', 
     ylab = 'Total Sugar in Starbucks Food',
     main = 'Total Fat Vs Sugar for Starbucks Drinks', 
     data = drinks_expanded)
abline(h=38,col='red')
```

### Plot Strar Bucks Drink (Sugars and Caffine)
```{r, warning=FALSE, message=FALSE}
# Blue line Max recomendation of sugar
# Red line Max recomendation of caffine

# https://www.fda.gov/consumers/consumer-updates/spilling-beans-how-much-caffeine-too-much

sudo<-drinks_expanded %>%
  mutate(clean_caff=as.numeric(as.character(drinks_expanded$Caffeine)))
sudo[is.na(sudo)]<-0

plot(clean_caff~Sugars, 
     ylab = 'Caffeine in Starbucks Drinks', 
     xlab = 'Sugar in Starbucks Food',
     main = 'Total Fat Vs Sugar for Starbucks Drinks', 
     data = sudo)
abline(h=400,col='red')
abline(v=38,col='blue')

#Venti Coffee
sudo %>%
  select(Beverage_category,clean_caff) %>%
  filter(clean_caff>=400)

sudo %>%
  select(Beverage_category,Sugars) %>%
  filter(Sugars>=38) %>% 
  count(Beverage_category) %>% 
  ungroup() %>% 
  arrange(desc(n))

sudo_sugar<-sudo %>%
  select(Beverage_category,Sugars) %>%
  filter(Sugars>=38) 

# 37.60331% of drinks have higher than rated sugar
length(sudo_sugar[,1])/length(drinks_expanded$Beverage_category)

if(FALSE){
"
Worst drinks ordered by violation of sugar contents
Frappuccino Blended Coffee				
Signature Espresso Drinks				
Tazo Tea Drinks  
"
}

```

#### Checking for missing values
It doesnt seems the data contains any missing values. However, Caffeine variable in the `Drinks Expanded` dataset seems to be a mixed of numeric and character. As it can be seen, there are values with value `varies` or `Varies` in the data. Removed them from the dataset and will format it into numeric variable.

```{r, warning=FALSE, message=FALSE, echo=FALSE}
summary(drinks_expanded)
summary(food)
drinks_expanded <- subset(drinks_expanded,!Caffeine %in% c('Varies','varies',''))
drinks_expanded$Caffeine <- as.numeric(as.character(drinks_expanded$Caffeine))
```












